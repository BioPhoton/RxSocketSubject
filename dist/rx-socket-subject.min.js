(function(){function m(a,l){function d(){1===++e&&(b=new t,h=new t,k=(c.g?c.g(f.k(b.map(function(a){return{type:"sub",value:a}}),h.map(function(a){return{type:"unsub",value:a}}))):f.k(b,h)).map(c.n).b(a))}var c={n:function(a){return JSON.stringify(a)},j:function(a){return JSON.parse(a.data)},g:null,e:null};l&&u(c,l);var b,h,e=0,k;return function(l,n,g){if(!g&&!c.m)throw"no response filter provided";g=g||c.m(l);return f.create(function(f){d();b.a(l);var w=(c.e?c.e(a):a).map(c.j).filter(g).b(f);return function(){h.a(n);
0===--e&&k.dispose();w.dispose()}})}}function u(a,b){for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);return a}function b(a){function b(){g||(e=new q,n=d.map(function(a){return"string"===typeof a?{url:a,protocol:null}:a}).s(function(a){return r.create(function(b){var d=x(a.url,a.protocol,y.create(function(a){p=!0;for(c&&c.a(a);0<k.length;)a=k.shift(),e.a(a)}),h);return new Rx.p(d["catch"](function(a){f&&f.a(a);throw a;})["finally"](function(){p=!1}).b(b),e.b(d))})})["finally"](function(){g=!1}).w().A(),
g=!0);return n}var d=this.connections=a.connections,c=this.f=a.f,f=this.d=a.d,h=this.c=a.c;a=new q;var e=new q,k=[],p=!1;a.b(function(a){p?e.a(a):k.push(a)},function(a){e&&e.v(a)},function(){e&&e.u()});var n,g=!1,m=r.create(function(a){return b().b(a)});v.call(this,a,m)}var f=Rx.h,t=Rx.i,q=Rx.i,r=Rx.h,y=Rx.r,x=Rx.q.t,v=Rx.o;b.prototype=u(Object.create(v.prototype),{constructor:b,l:function(a){return m(this,a)}});b.create=function(a,f,d,c){a instanceof r&&(console.warn("DEPRECATION: RxSocketSubject.create() should be called with a configuration object"),
a={connections:a,f:f,d:d,c:c});return new b(a)};b.l=m;"function"===typeof define&&define.amd?define(function(){return b}):"undefined"!==typeof module&&module.exports?module.exports=b:"undefined"!==typeof this&&(this.RxSocketSubject=b)}).call(this);
