(function(){function n(a,b,c){function e(){1===++k&&(l=new q,f=new q,h=(g.h?g.h(d.n(l.map(function(a){return{type:"sub",value:a}}),f.map(function(a){return{type:"unsub",value:a}}))):d.n(l,f)).map(g.q).b(a))}var g={q:function(a){return JSON.stringify(a)},l:function(a){return JSON.parse(a.data)},h:null,e:null};c&&r(g,c);var l,f,k=0,h;return function(c,m){return d.create(function(d){e();l.a(c);var v=(g.e?g.e(a):a).map(g.l).filter(b(c)).b(d);return function(){f.a(m);0===--k&&h.dispose();v.dispose()}})}}
function r(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function e(a){function b(){m||(d=p.create(function(a){var b=new Rx.u,d=new Rx.i(b,c.map(function(a){var b,c=null;"string"===typeof a?b=a:a&&a.url&&(b=a.url,c=a.protocol);return w(b,c,x.create(function(a){h=!0;for(e&&e.a(a);0<k.length;)a=k.shift(),f.a(a)}),l)}).b(function(c){b&&!b.m&&b.B(new Rx.i(c.b(function(b){a.a(b)},function(b){g&&g.a(b);h=!1;a.f(b)},function(){h=!1;a.p()}),f.b(c)))},a.f.bind(a)));return function(){h=!1;d&&
!d.m&&d.dispose()}})["finally"](function(){m=!1}).w().A(),m=!0);return d}var c=this.connections=a.connections,e=this.g=a.g,g=this.d=a.d,l=this.c=a.c;a=new t;var f=new t,k=[],h=!1;a.b(function(a){h?f.a(a):k.push(a)},f.f.bind(f),f.p.bind(f));var d,m=!1,n=p.create(function(a){return b().b(a)});u.call(this,a,n)}var d=Rx.j,q=Rx.k,t=Rx.k,p=Rx.j,x=Rx.t,w=Rx.s.v,u=Rx.r;e.prototype=r(Object.create(u.prototype),{constructor:e,o:function(a,b){return n(this,a,b)}});e.create=function(a,b,c,d){a instanceof p&&
(console.warn("DEPRECATION: RxSocketSubject.create() should be called with a configuration object"),a={connections:a,g:b,d:c,c:d});return new e(a)};e.o=n;"function"===typeof define&&define.amd?define(function(){return e}):"undefined"!==typeof module&&module.exports?module.exports=e:"undefined"!==typeof this&&(this.RxSocketSubject=e)}).call(this);
