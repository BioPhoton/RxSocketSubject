(function(){function n(a,l){function g(){1===++e&&(b=new r,h=new r,k=(d.h?d.h(f.n(b.map(function(a){return{type:"sub",value:a}}),h.map(function(a){return{type:"unsub",value:a}}))):f.n(b,h)).map(d.r).b(a))}var d={r:function(a){return JSON.stringify(a)},l:function(a){return JSON.parse(a.data)},h:null,e:null};l&&t(d,l);var b,h,e=0,k;return function(l,p,c){if(!c&&!d.q)throw"no response filter provided";c=c||d.q(l);return f.create(function(f){g();b.a(l);var w=(d.e?d.e(a):a).map(d.l).filter(c).b(f);return function(){h.a(p);
0===--e&&k.dispose();w.dispose()}})}}function t(a,b){for(var g in b)b.hasOwnProperty(g)&&(a[g]=b[g]);return a}function b(a){function b(){c||(p=q.create(function(a){var b=new Rx.v,c=new Rx.i(b,g.map(function(a){var b,c=null;"string"===typeof a?b=a:a&&a.url&&(b=a.url,c=a.protocol);return x(b,c,y.create(function(a){m=!0;for(d&&d.a(a);0<k.length;)a=k.shift(),e.a(a)}),h)}).b(function(c){b&&!b.m&&b.C(new Rx.i(c.b(function(b){a.a(b)},function(b){f&&f.a(b);m=!1;a.f(b)},function(){m=!1;a.p()}),e.b(c)))},a.f.bind(a)));
return function(){m=!1;c&&!c.m&&c.dispose()}})["finally"](function(){c=!1}).A().B(),c=!0);return p}var g=this.connections=a.connections,d=this.g=a.g,f=this.d=a.d,h=this.c=a.c;a=new u;var e=new u,k=[],m=!1;a.b(function(a){m?e.a(a):k.push(a)},e.f.bind(e),e.p.bind(e));var p,c=!1,n=q.create(function(a){return b().b(a)});v.call(this,a,n)}var f=Rx.j,r=Rx.k,u=Rx.k,q=Rx.j,y=Rx.u,x=Rx.t.w,v=Rx.s;b.prototype=t(Object.create(v.prototype),{constructor:b,o:function(a){return n(this,a)}});b.create=function(a,f,
g,d){a instanceof q&&(console.warn("DEPRECATION: RxSocketSubject.create() should be called with a configuration object"),a={connections:a,g:f,d:g,c:d});return new b(a)};b.o=n;"function"===typeof define&&define.amd?define(function(){return b}):"undefined"!==typeof module&&module.exports?module.exports=b:"undefined"!==typeof this&&(this.RxSocketSubject=b)}).call(this);
